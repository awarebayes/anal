# 4 Параллельные вычисления

Фундаментальное ограничение параллельных вычислений - запрет на одновременную запись из разных потоков в одну и ту же ячейку памяти

Требуется организация монопольнодо доступа на запись. А иногда и не только!

Мьютекс нужно использовать.

Мьютекс может быть заблокирован или освобожден.

Критическая секция - некоторый участок кода, в котором осуществляется монопольный доступ к данным. Используя мьютекс.

Пример:

```c++
void aboba()
{
    mutex::lock();
    do stuff;
}
```

Пример: несколько потоков одновременно (ситуация гонок) пытаются выполнить lock() - захват мьютекса m.

Часто работа нескольких вспомогательных потоков организуется следующим образом.
Обозначим тот поток который запускает рабочие потоки делегатом.

Затем запускает их и уходит в состояние ожидания.
Пока не будут решены все задачи или хотя бы одна.
Все подзадачи.

Windows: waitForAll(s)
S - массив семафоров.
Семафор примитив синхронизации. В данном случае бинарный флаг для сигналов

Установка семафора - последняя операция, тип выполнился.

Рабочий поток - выполняет задачу, записывает результат (часто через мьютекс), устанавливает семафор.

При запуске потока необходимо описать, какие параметры передаются в поток. Главный поток передает аргументы для делегата (указателя на функцию).

1) Ссылка (ссылки) на исходные данные. Указатель там.
2) Указание на границу области ответственности потока.
3) Ссылка на результат
4) Ссылка на mutex

(1 мьютекс на 1 общий разделяющий ответ, несколько потоков получат ссылку на один объект)

5) Ссылка на семафор.


